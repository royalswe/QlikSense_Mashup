define(["jquery","underscore","qlik","qvangular","./lib/js/pp-iconsets.js","./lib/external/lodash/lodash.js","./lib/js/components/pp-cl-about/pp-cl-about.js","./lib/js/components/pp-cl-update-button/pp-cl-update-button.js","./lib/js/components/pp-cl-icon-item/pp-cl-icon-item.js","./lib/js/components/pp-cl-selection-item-list/pp-cl-selection-item-list.js"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){var d=b||[],e=c||[];return Object.getOwnPropertyNames(a).reduce(function(b,c){return e.push(c),"object"==typeof a[c]?g(a[c],b,e):b.push(e.slice()),e.pop(),b},d)}var h=d.getService("$q"),i={propertiesVersion:"1.4.5",props:{target:{mode:!0,comparison:"relative",precision:1,comparisonType:"more_is_better",banding:10,layout:{mode:"standard"},comparisonLabel:"",iconUp:"arrow-up",iconRight:"arrow-right",iconDown:"arrow-down"},canTakeSnapshot:!0,canMaximize:!1,layout:{mode:"fill",marginType:"default",textSize:"medium",boldText:!1,color:{mode:!1}},kpiAlign:"middle",wrapKpiLabel:!1,hideKpiLabel:!1,hideTarget:!1,hideTargetLabel:!1,kpiLabel:"",targetLabel:"",backgroundImageMode:"none",backgroundContentLibraryImage:"",backgroundImageURL:"",backgroundImageSizeMode:"contain",iconSet:"charts",icon:"line-chart",hideIcon:!1,showIconWithTitle:!1,color:{icon:{mode:"custom"},customColors:{icon:{color:"#4477aa",index:6},good:{color:"#46c646",index:2},goodEnough:{color:"#ffcf02",index:8},bad:{color:"#f93f17",index:10},trend:{color:"#4477aa",index:6},targetTrend:{color:"#545352",index:14},text:{color:"#7b7a78",index:13},background:{color:"#4477aa",index:6}},colorExpressions:{icon:"RGB(0, 0, 128)",target:"RGB(0, 0, 128)",trend:"RGB(128, 128, 200)",targetTrend:"RGB(128, 128, 200)",text:"RGB(128, 128, 128)",background:"RGB(0, 0, 128)"},target:{mode:"3-colors"},trend:{iconIndependence:!1,mode:"auto",autoblend:!0,blendFactor:.3},targetTrend:{autoblend:!0,blendFactor:.3},other:{mode:"custom"},overlay:{opacity:.7,bgcolor:{color:"#545352",index:14},navigationColor:{color:"#ffffff",index:1}}},iconDirectionExpression:0,hoverMode:"none",sheetId:"",navigation:{showButton:!0,text:"See details"},actionBeforeNavigation:"none",field:"",value:"",values:"",valuesSeparatorComma:!0,valuesSeparatorCustom:",",variable:"",variableValue:""}},j=[{path:"props.layout.mode",value:"standard",newValue:"fill"}],k={qDef:{measureAxis:{autoMinMax:!1,minMax:"min",max:10,min:0},trend:{chartType:"area",showTargetTrend:!1,targetChartType:"line",showDatapoints:!1,showTargetDatapoints:!1},colorizeSetByExpression:!1}},l={},m=g(i),n=g(k),o=g(l),p=function(a,b){var c=a.split("."),d=b.split(".");if(3===c.length&&3===d.length){var e=1e6*c[0]+1e3*c[1]+c[2],f=1e6*d[0]+1e3*d[1]+d[2];return Number(e)<Number(f)}return!1},q=function(a){return a.propertiesVersion&&p("1.4.5",a.propertiesVersion)?!0:!1},r=function(a){if(q(a))return!1;var b,c;for(b=0;b<m.length;b++){var d=m[b];if(!f.hasIn(a,d))return!0}if(a.qHyperCubeDef.qDimensions.length>0)for(b=0;b<a.qHyperCubeDef.qDimensions.length;b++){var e=a.qHyperCubeDef.qDimensions[b];for(c=0;c<n.length;c++){var g=n[c];if(!f.hasIn(e,g))return!0}}if(a.qHyperCubeDef.qMeasures.length>0)for(b=0;b<a.qHyperCubeDef.qMeasures.length;b++){var h=a.qHyperCubeDef.qMeasures[b];for(c=0;c<o.length;c++){var i=o[c];if(!f.hasIn(h,i))return!0}}for(b=0;b<j.length;b++){var k=j[b];if(f.get(a,k.path)===k.value)return!0}return!1},s=function(a){var b=a.qHyperCubeDef.qMeasures.length+a.qHyperCubeDef.qDimensions.length;a.qHyperCubeDef.qInitialDataFetch[0].qWidth=b,a.qHyperCubeDef.qInitialDataFetch[0].qHeight=parseInt(1e4/b)},t={label:"This visualization was created with a more recent version of the extension. Please update the installed extension.",component:"text",show:q},u={label:"This visualization was created with an earlier version of the extension. Use the button below to update any new properties with default values.",component:"text",show:r},v={label:"Update properties",component:"pp-cl-kpi-update-button",action:function(b,c){var d=a.extend(!0,{},i,b);a.extend(!0,b,d);var e;if(b.qHyperCubeDef.qDimensions.length>0)for(e=0;e<b.qHyperCubeDef.qDimensions.length;e++){var g=a.extend(!0,{},k,b.qHyperCubeDef.qDimensions[e]);a.extend(!0,b.qHyperCubeDef.qDimensions[e],g)}if(b.qHyperCubeDef.qMeasures.length>0)for(e=0;e<b.qHyperCubeDef.qMeasures.length;e++){var h=a.extend(!0,{},l,b.qHyperCubeDef.qMeasures[e]);a.extend(!0,b.qHyperCubeDef.qMeasures[e],h)}for(e=0;e<j.length;e++){var m=j[e];if(f.get(b,m.path)===m.value){var n=m.newPath?m.newPath:m.path;f.set(b,n,m.newValue),m.deleteOldProperty&&f.unset(b,m.path)}}b.propertiesVersion=i.propertiesVersion,c()},show:r},w=c.currApp(),x=function(){return w.model.layout.qLocaleInfo},y=function(){var a=h.defer();return w.getAppObjectList(function(c){var d=[],e=b.sortBy(c.qAppObjectList.qItems,function(a){return a.qData.rank});return b.each(e,function(a){d.push({value:a.qInfo.qId,label:a.qMeta.title})}),a.resolve(d)}),a.promise},z=function(){var a=b.map(e,function(a,b){return{value:b,label:a.name}});return a},A=function(a){var c=b.map(e[a].icons,function(a){return{component:"cl-icon-item",labelPlacement:"hide",value:a}});return c},B={type:"string",component:"dropdown",label:"Select Sheet",ref:"props.sheetId",defaultValue:i.props.sheetId,options:function(){return y().then(function(a){return a})},show:function(a){return"navigation"===a.props.hoverMode}},C={type:"string",expression:"optional",ref:"props.navigation.text",translation:"Navigation text",defaultValue:i.props.navigation.text,show:function(a){return"navigation"===a.props.hoverMode}},D={component:"switch",ref:"props.navigation.showButton",label:"Show button",type:"boolean",defaultValue:i.props.navigation.showButton,options:[{value:!0,label:"Button"},{value:!1,label:"Text only"}],show:function(a){return"navigation"===a.props.hoverMode}},E={component:"color-picker",translation:"Navigation text color",ref:"props.color.overlay.navigationColor",type:"object",dualOutput:!0,defaultValue:i.props.color.overlay.navigationColor,show:function(a){return"navigation"===a.props.hoverMode}},F={type:"string",component:"dropdown",label:"Action before navigation",ref:"props.actionBeforeNavigation",defaultValue:i.props.actionBeforeNavigation,options:[{value:"none",label:"None"},{value:"clearSelectionsInField",label:"Clear selections in field"},{value:"selectValueInField",label:"Select value in field"},{value:"selectValuesInField",label:"Select values in field"},{value:"setVariable",label:"Set variable"}],show:function(a){return"navigation"===a.props.hoverMode}},G={ref:"props.field",defaultValue:i.props.field,label:"Field",type:"string",expression:"optional",expressionType:"dimension",show:function(a){return"navigation"===a.props.hoverMode&&("selectValueInField"===a.props.actionBeforeNavigation||"clearSelectionsInField"===a.props.actionBeforeNavigation||"selectValuesInField"===a.props.actionBeforeNavigation)}},H={label:"Dual fields, need numeric values need to be numeric for selections to be applied",component:"text",show:function(a){return"navigation"===a.props.hoverMode&&"selectValuesInField"===a.props.actionBeforeNavigation}},I={ref:"props.value",defaultValue:i.props.value,label:"Match String",type:"string",expression:"optional",show:function(a){return"navigation"===a.props.hoverMode&&"selectValueInField"===a.props.actionBeforeNavigation}},J={ref:"props.values",defaultValue:i.props.values,label:"Values",type:"string",expression:"optional",show:function(a){return"navigation"===a.props.hoverMode&&"selectValuesInField"===a.props.actionBeforeNavigation}},K={type:"boolean",component:"switch",label:"Values separator",ref:"props.valuesSeparatorComma",defaultValue:i.props.valuesSeparatorComma,options:[{value:!0,label:"Comma separator"},{value:!1,label:"Custom separator"}],show:function(a){return"navigation"===a.props.hoverMode&&"selectValuesInField"===a.props.actionBeforeNavigation}},L={type:"string",ref:"props.valuesSeparatorCustom",defaultValue:i.props.valuesSeparatorCustom,label:"Custom separator",show:function(a){return"navigation"===a.props.hoverMode&&"selectValuesInField"===a.props.actionBeforeNavigation&&!a.props.valuesSeparatorComma}},M={ref:"props.variable",defaultValue:i.props.variable,label:"Variable",type:"string",expression:"optional",show:function(a){return"navigation"===a.props.hoverMode&&"setVariable"===a.props.actionBeforeNavigation}},N={ref:"props.variableValue",defaultValue:i.props.variableValue,label:"Variable value",type:"string",expression:"optional",show:function(a){return"navigation"===a.props.hoverMode&&"setVariable"===a.props.actionBeforeNavigation}},O={ref:"props.hideKpiLabel",defaultValue:i.props.hideKpiLabel,label:"Hide KPI Label",type:"boolean",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]},P={ref:"props.wrapKpiLabel",defaultValue:i.props.wrapKpiLabel,label:"KPI Label in 2 lines",type:"boolean",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]},Q={ref:"props.kpiLabel",defaultValue:i.props.kpiLabel,label:"KPI label",type:"string",expression:"optional",readOnly:function(a){return a.props.hideKpiLabel}},R={ref:"props.hideTargetLabel",defaultValue:i.props.hideTargetLabel,label:"Hide Target Label",type:"boolean",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],show:function(a){return a.qHyperCubeDef.qMeasures.length>=2}},S={ref:"props.hideTarget",defaultValue:i.props.hideTarget,label:"Hide Target Measure",type:"boolean",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],show:function(a){return a.qHyperCubeDef.qMeasures.length>=2}},T={ref:"props.targetLabel",defaultValue:i.props.targetLabel,label:"Target label",type:"string",expression:"optional",show:function(a){return a.qHyperCubeDef.qMeasures.length>=2},readOnly:function(a){return a.props.hideTargetLabel}},U={ref:"props.target.comparisonLabel",defaultValue:i.props.comparisonLabel,label:"Comparison label",type:"string",expression:"optional",show:function(a){return a.props.target.mode&&"comparison"===a.props.target.layout.mode}},V={component:"buttongroup",ref:"props.kpiAlign",label:"Horizontal align",type:"string",defaultValue:i.props.kpiAlign,options:[{value:"left",label:"Left",tooltip:"Left align"},{value:"middle",label:"Middle",tooltip:"Middle align"},{value:"right",label:"Right",tooltip:"Right align"}]},W={component:"buttongroup",ref:"props.layout.textSize",label:"Text size",type:"string",defaultValue:i.props.layout.textSize,options:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}]},X={ref:"props.layout.boldText",label:"Bold text",type:"boolean",defaultValue:i.props.layout.boldText},Y={component:"dropdown",ref:"props.hoverMode",label:"Hover mode",type:"string",defaultValue:i.props.hoverMode,options:[{value:"none",label:"None"},{value:"tooltip",label:"Tooltip"},{value:"details",label:"Details"},{value:"navigation",label:"Navigation"}]},Z={component:"slider",ref:"props.color.overlay.opacity",label:"Overlay opacity",type:"number",defaultValue:i.props.color.overlay.opacity,min:0,max:1,step:.1,show:function(a){return"details"===a.props.hoverMode||"navigation"===a.props.hoverMode}},$={component:"color-picker",translation:"Overlay background color",ref:"props.color.overlay.bgcolor",type:"object",dualOutput:!0,defaultValue:i.props.color.overlay.bgcolor,show:function(a){return"details"===a.props.hoverMode||"navigation"===a.props.hoverMode}},_={component:"switch",ref:"props.target.mode",label:"Target mode",type:"boolean",defaultValue:i.props.target.mode,options:[{value:!0,label:"Enabled"},{value:!1,label:"Disabled"}],show:function(a){return a.qHyperCubeDef.qMeasures.length>=2}},aa={component:"switch",ref:"props.canTakeSnapshot",label:"Can take snapshot",type:"boolean",defaultValue:i.props.canTakeSnapshot,options:[{value:!0,label:"Enabled"},{value:!1,label:"Disabled"}],show:!0},ba={component:"switch",ref:"props.canMaximize",label:"Show maximize icon",type:"boolean",defaultValue:!0,options:[{value:!0,label:"Enabled"},{value:!1,label:"Disabled"}],show:!0},ca={component:"dropdown",ref:"props.target.layout.mode",label:"Text Layout",type:"string",defaultValue:i.props.target.layout.mode,options:[{value:"standard",label:"Standard"},{value:"kpiFocus",label:"KPI focus"},{value:"comparisonFocus",label:"Comparison focus"},{value:"comparison",label:"Comparison"},{value:"hideText",label:"Hide all text"}],show:!0},da={component:"dropdown",ref:"props.target.comparison",label:"Comparison",type:"string",defaultValue:i.props.target.comparison,options:[{value:"relative",label:"Relative"},{value:"absolute",label:"Absolute"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2}},ea={component:"buttongroup",ref:"props.target.precision",label:"Number of decimals",type:"number",defaultValue:i.props.target.precision,options:[{value:"0",label:"0",tooltip:"No decimals"},{value:"1",label:"1",tooltip:"1 decimal"},{value:"2",label:"2",tooltip:"2 decimals"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"relative"===a.props.target.comparison}},fa={component:"dropdown",ref:"props.target.comparisonType",label:"Comparison type",type:"string",defaultValue:i.props.target.comparisonType,options:[{value:"more_is_better",label:"More is better"},{value:"less_is_better",label:"Less is better"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2}},ga={ref:"props.target.banding",label:"Banding",type:"number",expression:"optional",defaultValue:i.props.target.banding,show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"3-colors"===a.props.color.target.mode}},ha={ref:"props.target.targetBandingHelpText",label:"Banding allows you to adjust threshold of the KPI's value compared to the target value. Relative mode in percentage. Absolute mode in non-percentage",type:"string",component:"text",show:function(a){return a.props.target.mode&&2===a.qHyperCubeDef.qMeasures.length&&"3-colors"===a.props.color.target.mode}},ia={ref:"props.layout.mode",type:"string",size:"large",label:"Layout mode",component:"cl-item-selection-list",defaultValue:i.props.layout.mode,horizontal:!0,items:[{component:"cl-icon-item",labelPlacement:"bottom",icon:"kpi-top-layout",value:"top",label:"Top"},{component:"cl-icon-item",labelPlacement:"bottom",icon:"kpi-fill-layout",value:"fill",label:"Fill"}],show:!0},ja={ref:"props.layout.marginType",type:"string",size:"medium",label:"Margins",component:"cl-item-selection-list",defaultValue:i.props.layout.marginType,horizontal:!0,items:[{component:"cl-icon-item",icon:"kpi-no-margins",value:"none"},{component:"cl-icon-item",icon:"kpi-default-margins",value:"default"},{component:"cl-icon-item",icon:"kpi-large-margins",value:"large"}],show:!0},ka={component:"switch",ref:"props.layout.color.mode",label:"Color layout mode",type:"boolean",defaultValue:i.props.layout.color.mode,options:[{value:!0,label:"Color background"},{value:!1,label:"Color icon and trend"}],show:!0},la={ref:"qDef.trend.chartType",label:"Trend chart type",type:"string",component:"item-selection-list",defaultValue:k.qDef.trend.chartType,horizontal:!0,items:[{icon:"æ",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.line",value:"line"},{icon:"ø",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.area",value:"area"},{icon:"∫",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.bar",value:"bar"}],show:!0},ma={ref:"qDef.trend.showDatapoints",label:"Show data points",type:"boolean",defaultValue:k.qDef.trend.showDatapoints,readOnly:function(a){return"line"!==a.qDef.trend.chartType}},na={ref:"qDef.trend.showZerosAsGaps",label:"Show zeros as gaps",type:"boolean",defaultValue:k.qDef.trend.showZerosAsGaps},oa={type:"items",items:{autoMinMax:{ref:"qDef.measureAxis.autoMinMax",type:"boolean",translation:"properties.axis.range",component:"switch",defaultValue:k.qDef.measureAxis.autoMinMax,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],show:!0},minMax:{type:"string",component:"dropdown",ref:"qDef.measureAxis.minMax",defaultValue:k.qDef.measureAxis.minMax,options:[{translation:"Common.Auto",value:"auto"},{translation:"properties.axis.min",value:"min"},{translation:"Common.Max",value:"max"},{translation:"properties.axis.minMax",value:"minMax"}],show:function(a){return a.qDef.measureAxis&&!a.qDef.measureAxis.autoMinMax}},min:{ref:"qDef.measureAxis.min",translation:"properties.axis.min",expression:"optional",type:"number",defaultValue:k.qDef.measureAxis.min,show:function(a){return a.qDef.measureAxis&&["min","minMax"].contains(a.qDef.measureAxis.minMax)&&!a.qDef.measureAxis.autoMinMax},invalid:function(a){return!(!a.qDef.measureAxis||"minMax"!==a.qDef.measureAxis.minMax)&&a.qDef.measureAxis.min>=a.qDef.measureAxis.max}},max:{ref:"qDef.measureAxis.max",translation:"Common.Max",expression:"optional",type:"number",defaultValue:k.qDef.measureAxis.max,show:function(a){return a.qDef.measureAxis&&["max","minMax"].contains(a.qDef.measureAxis.minMax)&&!a.qDef.measureAxis.autoMinMax},invalid:function(a){return!(!a.qDef.measureAxis||"minMax"!==a.qDef.measureAxis.minMax)&&a.qDef.measureAxis.min>=a.qDef.measureAxis.max}}},show:!0},pa={component:"switch",ref:"qDef.trend.showTargetTrend",label:"Show target trend",type:"boolean",defaultValue:k.qDef.trend.showTargetTrend,options:[{value:!0,label:"Show"},{value:!1,label:"Hide"}],show:function(a,b){return b.hcProperties.qMeasures.length>=2}},qa={ref:"qDef.trend.targetChartType",label:"Target chart type",type:"string",component:"item-selection-list",defaultValue:k.qDef.trend.targetChartType,horizontal:!0,items:[{icon:"æ",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.line",value:"line"},{icon:"ø",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.area",value:"area"},{icon:"É",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.marker",value:"marker"}],show:function(a,b){return a.qDef.trend.showTargetTrend&&b.hcProperties.qMeasures.length>=2}},ra={ref:"qDef.trend.showTargetDatapoints",label:"Show data points",type:"boolean",defaultValue:k.qDef.trend.showTargetDatapoints,readOnly:function(a,b){return"line"===a.qDef.trend.targetChartType?!1:b.hcProperties.qMeasures.length>=2&&a.qDef.trend.showTargetTrend&&"line"===a.qDef.trend.targetChartType?!1:!0},show:function(a,b){return a.qDef.trend.showTargetTrend&&b.hcProperties.qMeasures.length>=2}},sa=function(a){return!a.props.target.mode||a.qHyperCubeDef.qMeasures.length<2},ta={ref:"props.showIconWithTitle",label:"Show icon with title",type:"boolean",defaultValue:i.props.showIconWithTitle,show:!0},ua={ref:"props.hideIcon",label:"Hide icon",type:"boolean",defaultValue:i.props.hideIcon,show:!0},va={component:"dropdown",ref:"props.iconSet",label:"Icon set",type:"string",defaultValue:i.props.iconSet,options:z(),show:function(a){return sa(a)}},wa={ref:"props.target.iconUp",label:"Good icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.target.iconUp,horizontal:!0,items:[{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-double-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-o-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-square-o-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-circle-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"long-arrow-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"check-square-up"},{component:"cl-icon-item",labelPlacement:"hide",value:"smile-o-up"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2}},xa={ref:"props.target.iconRight",type:"string",label:"Good enough icon",component:"cl-item-selection-list",defaultValue:i.props.target.iconRight,horizontal:!0,items:[{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-double-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-o-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-square-o-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-circle-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"long-arrow-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"minus-square-right"},{component:"cl-icon-item",labelPlacement:"hide",value:"meh-o-right"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"2-colors"!==a.props.color.target.mode}},ya={ref:"props.target.iconDown",type:"string",label:"Bad icon",component:"cl-item-selection-list",defaultValue:i.props.target.iconDown,horizontal:!0,items:[{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"angle-double-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"arrow-circle-o-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"caret-square-o-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"chevron-circle-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"long-arrow-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"window-close-down"},{component:"cl-icon-item",labelPlacement:"hide",value:"frown-o-down"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2}},za={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("charts"),show:function(a){return sa(a)&&"charts"===a.props.iconSet}},Aa={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("brands"),show:function(a){return sa(a)&&"brands"===a.props.iconSet}},Ba={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("transportation"),show:function(a){return sa(a)&&"transportation"===a.props.iconSet}},Ca={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("people"),show:function(a){return sa(a)&&"people"===a.props.iconSet}},Da={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("commerce"),show:function(a){return sa(a)&&"commerce"===a.props.iconSet}},Ea={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("navigation"),show:function(a){return sa(a)&&"navigation"===a.props.iconSet}},Fa={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("symbols"),show:function(a){return sa(a)&&"symbols"===a.props.iconSet}},Ga={ref:"props.icon",type:"string",component:"cl-item-selection-list",defaultValue:i.props.icon,horizontal:!0,items:A("other"),show:function(a){return sa(a)&&"other"===a.props.iconSet}},Ha={component:"dropdown",ref:"props.color.icon.mode",label:"Icon color mode",type:"string",defaultValue:i.props.color.icon.mode,options:[{value:"custom",label:"Custom"},{value:"byExpression",label:"Expression"}],show:function(a){return sa(a)||a.props.layout.color.mode}},Ia={type:"items",items:{colorTrendIconIndependence:{component:"switch",ref:"props.color.trend.iconIndependence",label:"Trend color",type:"boolean",defaultValue:i.props.color.trend.iconIndependence,options:[{value:!1,label:"Same as icon"},{value:!0,label:"Independent of icon"}],show:function(a){return 1===a.qHyperCubeDef.qDimensions.length}},colorTrendMode:{component:"dropdown",ref:"props.color.trend.mode",label:"Trend color mode",type:"string",defaultValue:i.props.color.trend.mode,options:[{value:"custom",label:"Custom"},{value:"byExpression",label:"Expression"}],show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&(a.props.color.trend.iconIndependence||a.qHyperCubeDef.qDimensions[0].qDef.trend.showTargetTrend)}},customTrendColor:{component:"color-picker",translation:"Trend",ref:"props.color.customColors.trend",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.trend.color,index:i.props.color.customColors.trend.index},show:function(a){return a.props.color.trend.iconIndependence&&1===a.qHyperCubeDef.qDimensions.length&&"custom"===a.props.color.trend.mode}},trendColorExpression:{type:"string",expression:"optional",ref:"props.color.colorExpressions.trend",translation:"Trend color expression",defaultValue:i.props.color.colorExpressions.trend,show:function(a){return a.props.color.trend.iconIndependence&&1===a.qHyperCubeDef.qDimensions.length&&"byExpression"===a.props.color.trend.mode}},colorTrendBlend:{component:"switch",ref:"props.color.trend.autoblend",label:"Blend trend with background",type:"boolean",defaultValue:i.props.color.trend.autoblend,options:[{value:!0,label:"Auto"},{value:!1,label:"Custom blend"}],show:function(a){return 1===a.qHyperCubeDef.qDimensions.length}},colorTrendBlendFactor:{component:"slider",ref:"props.color.trend.blendFactor",label:"Blend factor",type:"number",defaultValue:i.props.color.trend.blendFactor,min:0,max:1,step:.1,show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&!a.props.color.trend.autoblend}},customTargetTrendColor:{component:"color-picker",translation:"Target trend",ref:"props.color.customColors.targetTrend",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.targetTrend.color,index:i.props.color.customColors.targetTrend.index},show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&a.qHyperCubeDef.qDimensions[0].qDef.trend.showTargetTrend&&a.qHyperCubeDef.qMeasures.length>=2&&"custom"===a.props.color.trend.mode}},targetTrendColorExpression:{type:"string",expression:"optional",ref:"props.color.colorExpressions.targetTrend",translation:"Target trend color expression",defaultValue:i.props.color.colorExpressions.targetTrend,show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&a.qHyperCubeDef.qDimensions[0].qDef.trend.showTargetTrend&&a.qHyperCubeDef.qMeasures.length>=2&&"byExpression"===a.props.color.trend.mode}},colorTargetTrendBlend:{component:"switch",ref:"props.color.targetTrend.autoblend",label:"Blend target trend with background",type:"boolean",defaultValue:i.props.color.targetTrend.autoblend,options:[{value:!0,label:"Auto"},{value:!1,label:"Custom blend"}],show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&a.qHyperCubeDef.qDimensions[0].qDef.trend.showTargetTrend&&a.qHyperCubeDef.qMeasures.length>=2}},colorTargetTrendBlendFactor:{component:"slider",ref:"props.color.targetTrend.blendFactor",label:"Blend factor",type:"number",defaultValue:i.props.color.targetTrend.blendFactor,min:0,max:1,step:.1,show:function(a){return 1===a.qHyperCubeDef.qDimensions.length&&a.qHyperCubeDef.qDimensions[0].qDef.trend.showTargetTrend&&a.qHyperCubeDef.qMeasures.length>=2&&!a.props.color.targetTrend.autoblend}}}},Ja={component:"dropdown",ref:"props.color.other.mode",label:"Other colors mode",type:"string",defaultValue:i.props.color.other.mode,options:[{value:"custom",label:"Custom"},{value:"byExpression",label:"Expression"}],show:function(){return!0}},Ka={component:"dropdown",ref:"props.color.target.mode",label:"Target color mode",type:"string",defaultValue:i.props.color.target.mode,options:[{value:"2-colors",label:"Two colors"},{value:"3-colors",label:"Three colors"},{value:"byExpression",label:"Expression"}],show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2}},La={type:"items",items:{customIcon:{component:"color-picker",translation:"Icon",ref:"props.color.customColors.icon",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.icon.color,index:i.props.color.customColors.icon.index},show:function(a){return(sa(a)||a.props.layout.color.mode)&&"custom"===a.props.color.icon.mode}}}},Ma={type:"items",items:{customColorGood:{component:"color-picker",translation:"Good",ref:"props.color.customColors.good",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.good.color,index:i.props.color.customColors.good.index},show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"byExpression"!==a.props.color.target.mode}},customColorGoodEnough:{component:"color-picker",translation:"Good enough",ref:"props.color.customColors.goodEnough",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.goodEnough.color,index:i.props.color.customColors.goodEnough.index},show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"3-colors"===a.props.color.target.mode}},customColorBad:{component:"color-picker",translation:"Bad",ref:"props.color.customColors.bad",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.bad.color,index:i.props.color.customColors.bad.index},show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"byExpression"!==a.props.color.target.mode}}}},Na={type:"items",items:{customText:{component:"color-picker",translation:"Text",ref:"props.color.customColors.text",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.text.color,index:i.props.color.customColors.text.index},show:function(a){return"custom"===a.props.color.other.mode}},customBackground:{component:"color-picker",translation:"Background",ref:"props.color.customColors.background",type:"object",dualOutput:!0,defaultValue:{color:i.props.color.customColors.background.color,index:i.props.color.customColors.background.index},show:function(a){return sa(a)&&a.props.layout.color.mode&&"custom"===a.props.color.other.mode}}}},Oa={type:"string",expression:"optional",ref:"props.color.colorExpressions.icon",translation:"Icon color expression",defaultValue:i.props.color.colorExpressions.icon,show:function(a){return(sa(a)||a.props.layout.color.mode)&&"byExpression"===a.props.color.icon.mode}},Pa={type:"string",expression:"optional",ref:"props.color.colorExpressions.target",translation:"Target color expression",defaultValue:i.props.color.colorExpressions.target,show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"byExpression"===a.props.color.target.mode}},Qa={type:"number",expression:"optional",ref:"props.iconDirectionExpression",translation:"Icon direction expression",defaultValue:i.props.iconDirectionExpression,show:function(a){return a.props.target.mode&&a.qHyperCubeDef.qMeasures.length>=2&&"byExpression"===a.props.color.target.mode}},Ra={type:"string",expression:"optional",ref:"props.color.colorExpressions.text",translation:"Text color expression",defaultValue:i.props.color.colorExpressions.text,show:function(a){return"byExpression"===a.props.color.other.mode}},Sa={type:"string",expression:"optional",ref:"props.color.colorExpressions.background",translation:"Icon and trend color expression",defaultValue:i.props.color.colorExpressions.background,show:function(a){return sa(a)&&a.props.layout.color.mode&&"byExpression"===a.props.color.other.mode}},Ta={component:"pp-cl-kpi",translation:"Common.About",show:!0},Ua={type:"string",component:"dropdown",label:"Background image",ref:"props.backgroundImageMode",defaultValue:i.props.backgroundImageMode,options:[{value:"none",label:"None"
},{value:"url",label:"Image Url"},{value:"contentlibrary",label:"Content library media"},{value:"icon",label:"Icon"}]},Va={label:"Background image",component:"media",ref:"props.backgroundContentLibraryImage",layoutRef:"props.backgroundContentLibraryImage",type:"string",show:function(a){return"contentlibrary"===a.props.backgroundImageMode}},Wa={type:"string",expression:"optional",ref:"props.backgroundImageURL",translation:"Background image url",defaultValue:i.props.backgroundImageURL,show:function(a){return"url"===a.props.backgroundImageMode}},Xa={type:"string",component:"dropdown",label:"Image Size Mode",ref:"props.backgroundImageSizeMode",defaultValue:i.props.backgroundImageSizeMode,options:[{value:"contain",label:"Contain"},{value:"cover",label:"Cover"},{value:"fill",label:"Fill"}],show:function(a){return"url"===a.props.backgroundImageMode||"contentlibrary"===a.props.backgroundImageMode}},Ya={translation:"Common.About",type:"items",items:{about:Ta,updatePropertiesInfo:u,updateProperties:v,updateExtensionInfo:t}},Za={uses:"settings",items:{general:{type:"items",items:{canTakeSnapshot:aa,canMaximize:ba}},layout:{type:"items",grouped:!0,label:"Layout",items:{layout:{type:"items",label:"Layout",items:{layoutMode:ia,targetLayoutMode:ca,marginType:ja,kpiAlign:V,textSize:W,boldText:X}},labels:{type:"items",label:"Labels",items:{hideKpiLabel:O,wrapKpiLabel:P,kpiLabel:Q,hideTarget:S,hideTargetLabel:R,targetLabel:T,comparisonLabel:U}},background:{type:"items",label:"Background",items:{backgroundImageMode:Ua,backgroundContentLibraryImage:Va,backgroundImage:Wa,backgroundImageSizeMode:Xa}}}},iconSettings:{type:"items",label:"Icon",items:{showIconWithTitle:ta,hideIcon:ua,iconSet:va,iconsBrands:Aa,iconsChart:za,iconsTransportation:Ba,iconsPeople:Ca,iconsCommerce:Da,iconsNavigation:Ea,iconsSymbols:Fa,iconsOther:Ga,iconsTargetUp:wa,iconsTargetRight:xa,iconsTargetDown:ya}},colorSettings:{type:"items",label:"Colors",items:{colorBackground:ka,colorTargetMode:Ka,customTargetColors:Ma,targetColorExpression:Pa,iconDirectionExpression:Qa,colorIconMode:Ha,customIconColors:La,iconColorExpression:Oa,colorTrend:Ia,colorOtherMode:Ja,customOtherColors:Na,textColorExpression:Ra,backgroundColorExpression:Sa}},hoverSettings:{type:"items",grouped:!0,label:"Hover",items:{navgiationAction:{type:"items",label:"Hover",items:{hoverMode:Y,sheetList:B,actionBeforeNavigation:F,field:G,value:I,valuesText:H,values:J,valuesSeparatorComma:K,valuesSeparatorCustom:L,variable:M,variableValue:N}},navigationAppearance:{type:"items",label:"Hover",items:{navigationText:C,navigationColor:E,navigationButton:D,overlayBackgroundColor:$,overlayOpacity:Z}}}}}},$a={label:"Add another measure if you want to use the target mode",component:"text",show:function(a){return a.qHyperCubeDef.qMeasures&&a.qHyperCubeDef.qMeasures.length<2}},_a={type:"items",label:"Target",items:{noTargetText:$a,targetMode:_,targetComparison:da,targetComparisonRelativePrecision:ea,targetComparisonType:fa,targetBanding:ga,targetBandingHelpText:ha},show:!0},ab={uses:"dimensions",min:0,max:1,add:function(a,b){s(b);var c=b.qHyperCubeDef.qInterColumnSortOrder;c.unshift(c.pop())},remove:function(a,b){s(b)},translation:"Trend",items:{title:{show:!1},trendChart:{type:"items",grouped:!0,label:"Trend chart",items:{trend:{type:"items",items:{trendChartType:la,trendShowDatapoints:ma,trendShowZerosAsGaps:na}},target:{type:"items",items:{showTargetTrend:pa,trendTargetChartType:qa,trendTargetShowDatapoints:ra}},range:{type:"items",items:{showTrendMinMax:oa}}},show:!0}}},bb={component:"switch",ref:"qDef.colorizeSetByExpression",label:"Colors",type:"boolean",defaultValue:k.qDef.colorizeSetByExpression,options:[{value:!0,label:"Colors by expression"},{value:!1,label:"Use banding colors"}],show:function(a){return a.qDef.colorizeDatapoint}},cb={type:"boolean",ref:"qDef.colorizeDatapoint",label:function(a,b){return a===b.hcProperties.qMeasures[0]?"Colorize bars":"Colorize markers"},defaultValue:!1,show:function(a,b){return a===b.hcProperties.qMeasures[0]||a===b.hcProperties.qMeasures[1]?!0:!1}},db={component:"expression",expressionType:"measure",ref:"qAttributeExpressions.0.qExpression",label:function(a,b){return a===b.hcProperties.qMeasures[0]?"Bars color":"Markers color"},defaultValue:"",show:function(a){return a.qDef.colorizeDatapoint&&a.qDef.colorizeSetByExpression}},eb={uses:"measures",min:1,max:3,add:function(a,b){s(b);var c=x(),d=c.qThousandSep?c.qThousandSep:",",e=c.qDecimalSep?c.qDecimalSep:".",f="#"+d+"##0";a.qDef.qNumFormat={qType:"F",qnDec:2,qUseThou:0,qFmt:f,qDec:e,qThou:d}},remove:function(a,b){s(b)},items:{colorizeDatapoint:cb,colorizeExpression:bb,datapointColor:db}},fb={uses:"sorting"},gb={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:{show:!0}}}}};return{type:"items",component:"accordion",items:{measures:eb,target:_a,dimensions:ab,sorting:fb,addons:gb,appearance:Za,about:Ya}}});